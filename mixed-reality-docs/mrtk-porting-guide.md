---
title: 让现有应用准备好使用 HoloLens 2
description: 本文面向目前已在 HoloLens（第 1 代）和/或早期 MRTK 上拥有应用，且希望移植到 MRTK 版本 2 和 HoloLens 2 的开发人员。
author: grbury
ms.author: grbury
ms.date: 07/29/2020
ms.topic: article
ms.localizationpriority: high
keywords: Windows Mixed Reality, 测试, MRTK, MRTK 版本 2, HoloLens 2
ms.openlocfilehash: a6d6c4ad2b9ec0de2663536f2299f31f7d79571a
ms.sourcegitcommit: ef0bf03833eda826ed0b884859b4573775112aba
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/31/2020
ms.locfileid: "87476989"
---
# <a name="get-your-existing-app-ready-for-hololens-2"></a><span data-ttu-id="b5072-104">让现有应用准备好使用 HoloLens 2</span><span class="sxs-lookup"><span data-stu-id="b5072-104">Get your existing app ready for HoloLens 2</span></span>

## <a name="overview"></a><span data-ttu-id="b5072-105">概述</span><span class="sxs-lookup"><span data-stu-id="b5072-105">Overview</span></span>

<span data-ttu-id="b5072-106">本指南帮助开发人员移植其适用于 HoloLens（第 1 代）的现有 Unity 应用程序，使其可在 HoloLens 2 设备上运行。</span><span class="sxs-lookup"><span data-stu-id="b5072-106">This guide is tailored to help developers with an existing Unity application for HoloLens (1st gen) port their application for the HoloLens 2 device.</span></span> <span data-ttu-id="b5072-107">将 HoloLens（第 1 代）Unity 应用程序移植到 HoloLens 2 需要完成四个关键步骤。</span><span class="sxs-lookup"><span data-stu-id="b5072-107">There are four key steps to porting a HoloLens (1st gen) Unity application to HoloLens 2.</span></span> 

<span data-ttu-id="b5072-108">以下部分将提供每个阶段的详细信息：</span><span class="sxs-lookup"><span data-stu-id="b5072-108">The sections below detail information for each stage:</span></span>

| <span data-ttu-id="b5072-109">步骤 1</span><span class="sxs-lookup"><span data-stu-id="b5072-109">Step 1</span></span> | <span data-ttu-id="b5072-110">步骤 2</span><span class="sxs-lookup"><span data-stu-id="b5072-110">Step 2</span></span> | <span data-ttu-id="b5072-111">步骤 3</span><span class="sxs-lookup"><span data-stu-id="b5072-111">Step 3</span></span> | <span data-ttu-id="b5072-112">步骤 4</span><span class="sxs-lookup"><span data-stu-id="b5072-112">Step 4</span></span> |
|----------|-------------------|-------------------|-------------------|
| ![Visual Studio 徽标](images/visualstudio_logo.png) | ![Unity 徽标](images/final_unity_logo.png)| ![Unity 图标](images/hololens2_icon.jpg) | ![MRTK 徽标](images/final_mrtk-small_logo.png) |
| <span data-ttu-id="b5072-117">下载最新的工具</span><span class="sxs-lookup"><span data-stu-id="b5072-117">Download latest tools</span></span> | <span data-ttu-id="b5072-118">更新 Unity 项目</span><span class="sxs-lookup"><span data-stu-id="b5072-118">Update Unity Project</span></span> | <span data-ttu-id="b5072-119">ARM 编译</span><span class="sxs-lookup"><span data-stu-id="b5072-119">Compile for ARM</span></span> | <span data-ttu-id="b5072-120">迁移到 MRTK v2</span><span class="sxs-lookup"><span data-stu-id="b5072-120">Migrate to MRTK v2</span></span>

<span data-ttu-id="b5072-121">先决条件：</span><span class="sxs-lookup"><span data-stu-id="b5072-121">Prerequisites:</span></span>

<span data-ttu-id="b5072-122">强烈建议在开始迁移过程之前，使用源代码管理保存应用程序原始状态的快照。</span><span class="sxs-lookup"><span data-stu-id="b5072-122">It's **highly recommended** that you use source control to save a snapshot your applications original state before starting the porting process.</span></span> <span data-ttu-id="b5072-123">此外，建议在迁移过程中的不同时间保存检查点状态。</span><span class="sxs-lookup"><span data-stu-id="b5072-123">Additionally, we recommend *saving* checkpoint states at various times during the process.</span></span> <span data-ttu-id="b5072-124">再保留一个原始应用程序的 Unity 实例也很有帮助，这便于在移植过程中进行并列比较。</span><span class="sxs-lookup"><span data-stu-id="b5072-124">It can also be helpful to have another Unity instance of the original application to compare side-by-side during the porting process.</span></span> 

> [!NOTE]
> <span data-ttu-id="b5072-125">在移植之前，请确保已安装用于 Windows Mixed Reality 开发的最新工具。</span><span class="sxs-lookup"><span data-stu-id="b5072-125">Before porting, ensure you have the latest tools installed for Windows Mixed Reality development.</span></span> <span data-ttu-id="b5072-126">对于当前大部分 HoloLens 开发人员而言，这涉及到更新到最新版的 Visual Studio 2019 并安装相应的 Windows SDK。</span><span class="sxs-lookup"><span data-stu-id="b5072-126">For most existing HoloLens developers, this involves updating to the latest version of Visual Studio 2019 and installing the appropriate Windows SDK.</span></span> <span data-ttu-id="b5072-127">以下内容会深入到不同的 Unity 版本和混合现实工具包 (MRTK) 版本 2。</span><span class="sxs-lookup"><span data-stu-id="b5072-127">The content that follows dives further into different Unity versions and the Mixed Reality Toolkit (MRTK) Version 2.</span></span>
>
> <span data-ttu-id="b5072-128">有关详细信息，请参阅[安装工具](install-the-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="b5072-128">For more information, please see [Install the tools](install-the-tools.md).</span></span>

## <a name="migrate-project-to-the-latest-version-of-unity"></a><span data-ttu-id="b5072-129">将项目迁移到最新版本的 Unity</span><span class="sxs-lookup"><span data-stu-id="b5072-129">Migrate project to the latest version of Unity</span></span>

<span data-ttu-id="b5072-130">如果使用 [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity)，则 [Unity 2019 LTS](https://unity3d.com/unity/qa/lts-releases) 是最佳的长期支持路径，它不会在 Unity 或 MRTK 中造成中断性变更。</span><span class="sxs-lookup"><span data-stu-id="b5072-130">If you're using [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity), [Unity 2019 LTS](https://unity3d.com/unity/qa/lts-releases) is the best long-term support path with no breaking changes in Unity or in MRTK.</span></span> <span data-ttu-id="b5072-131">应评估项目中当前存在的所有[插件依赖项](https://docs.unity3d.com/Manual/Plugins.html)，并确定是否可为 ARM64 生成这些 DLL。</span><span class="sxs-lookup"><span data-stu-id="b5072-131">You should assess any [plugin dependencies](https://docs.unity3d.com/Manual/Plugins.html) that currently exist in your project, and determine whether or not these DLLs can be built for ARM64.</span></span> <span data-ttu-id="b5072-132">如果无法为 ARM64 生成必需的依赖项插件，则需继续为 ARM 生成应用。</span><span class="sxs-lookup"><span data-stu-id="b5072-132">If a hard dependency plugin cannot be built for ARM64, you may need to continue building your app for ARM.</span></span>

<!-- MRTK v2 always guarantees support for Unity 2018 LTS, but does not necessarily guarantee support for every iteration of Unity 2019.x.

To help clarify additional differences between [Unity 2018 LTS](https://unity3d.com/unity/qa/lts-releases) and Unity 2019.x, the following table outlines the trade-offs between the two versions. The primary difference between the two is the ability to compile for ARM64 in Unity 2019.

| Unity 2018 LTS | Unity 2019.x |
|----------|-------------------|
| ARM32 build support | ARM32 and ARM64 build support |
| Stable LTS build release | Beta stability |
| [.NET Scripting back-end](https://docs.unity3d.com/2018.4/Documentation/Manual/windowsstore-dotnet.html) *deprecated* | [.NET Scripting back-end](https://docs.unity3d.com/2018.4/Documentation/Manual/windowsstore-dotnet.html) *removed* |
| UNET Networking *deprecated* | UNET Networking *deprecated* |

-->

## <a name="update-sceneproject-settings-in-unity"></a><span data-ttu-id="b5072-133">在 Unity 中更新场景/项目设置</span><span class="sxs-lookup"><span data-stu-id="b5072-133">Update scene/project settings in Unity</span></span>

<span data-ttu-id="b5072-134">更新到 [Unity 2019 LTS](https://unity3d.com/unity/qa/lts-releases) 之后，建议在 Unity 中更新特定设置，以便在设备上获得最佳结果。</span><span class="sxs-lookup"><span data-stu-id="b5072-134">After updating to [Unity 2019 LTS](https://unity3d.com/unity/qa/lts-releases), it's recommended that you update particular settings in Unity for optimal results on the device.</span></span> <span data-ttu-id="b5072-135">[Unity 的建议设置](Recommended-settings-for-Unity.md)中详细描述了这些设置。</span><span class="sxs-lookup"><span data-stu-id="b5072-135">These settings are outlined in detail under [recommended settings for Unity](Recommended-settings-for-Unity.md).</span></span>

<span data-ttu-id="b5072-136">再次重申，[.NET 脚本后端](https://docs.unity3d.com/Manual/windowsstore-dotnet.html)即将在 Unity 2018 中弃用，并将在 Unity 2019 中删除。</span><span class="sxs-lookup"><span data-stu-id="b5072-136">It should be reiterated that the [.NET scripting back-end](https://docs.unity3d.com/Manual/windowsstore-dotnet.html) is being deprecated in Unity 2018 and *removed* in Unity 2019.</span></span> <span data-ttu-id="b5072-137">强烈建议开发人员将其项目切换到 [IL2CPP](https://docs.unity3d.com/Manual/IL2CPP.html)。</span><span class="sxs-lookup"><span data-stu-id="b5072-137">Developers should strongly consider switching their project to [IL2CPP](https://docs.unity3d.com/Manual/IL2CPP.html).</span></span>

> [!NOTE]
> <span data-ttu-id="b5072-138">IL2CPP 脚本后端可能导致增大从 Unity 到 Visual Studio 的生成时间，因此，开发人员应设置好其计算机，以[优化 IL2CPP 生成时间](https://docs.unity3d.com/Manual/IL2CPP-OptimizingBuildTimes.html)。</span><span class="sxs-lookup"><span data-stu-id="b5072-138">IL2CPP scripting back-end can cause longer build times from Unity to Visual Studio, and developers should set up their developer machine for [optimizing IL2CPP build times](https://docs.unity3d.com/Manual/IL2CPP-OptimizingBuildTimes.html).</span></span>
> <span data-ttu-id="b5072-139">此外，设置[缓存服务器](https://docs.unity3d.com/Manual/CacheServer.html)可能会有所帮助，尤其是对于包含大量资产（不包括脚本文件）或不断变化的场景和资产的 Unity 项目而言。</span><span class="sxs-lookup"><span data-stu-id="b5072-139">It might also be beneficial to set up a [cache server](https://docs.unity3d.com/Manual/CacheServer.html), especially for Unity projects with a large amount of assets (excluding script files) or constantly changing scenes and assets.</span></span> <span data-ttu-id="b5072-140">打开项目时，Unity 会在开发人员计算机上将符合条件的资产存储为内部缓存格式。</span><span class="sxs-lookup"><span data-stu-id="b5072-140">When opening a project, Unity stores qualifying assets into an internal cache format on the developer machine.</span></span> <span data-ttu-id="b5072-141">必须重新导入项，项在修改后会重新经过处理。</span><span class="sxs-lookup"><span data-stu-id="b5072-141">Items must be re-imported and re-processed when modified.</span></span> <span data-ttu-id="b5072-142">此过程可以执行一次，结果可保存在缓存服务器，因此可与其他开发人员共享以节省时间，无需让每个开发人员在本地重新导入新的更改。</span><span class="sxs-lookup"><span data-stu-id="b5072-142">This process can be done once and saved in a cache server and consequently shared with other developers to save time, as opposed to every developer processing the re-import of new changes locally.</span></span>

<span data-ttu-id="b5072-143">在处理完因移至 Unity 更新版而导致的所有中断性变更后，应在 HoloLens（第 1 代）上构建和测试你目前的应用程序。</span><span class="sxs-lookup"><span data-stu-id="b5072-143">After addressing any breaking changes from moving to the updated Unity version, you should build and test your current applications on HoloLens (1st gen).</span></span> <span data-ttu-id="b5072-144">在此阶段很适合在源代码管理中创建并保存提交内容。</span><span class="sxs-lookup"><span data-stu-id="b5072-144">This is a good time to create and save a commit into source control.</span></span>

## <a name="compile-dependenciesplugins-for-arm-processor"></a><span data-ttu-id="b5072-145">编译 ARM 处理器的依赖项/插件</span><span class="sxs-lookup"><span data-stu-id="b5072-145">Compile dependencies/plugins for ARM processor</span></span>

<span data-ttu-id="b5072-146">HoloLens（第 1 代）在 x86 处理器上执行应用程序，而 HoloLens 2 则使用 ARM 处理器。</span><span class="sxs-lookup"><span data-stu-id="b5072-146">HoloLens (1st gen) executes applications on an x86 processor while the HoloLens 2 uses an ARM processor.</span></span> <span data-ttu-id="b5072-147">因此，需要移植现有的 HoloLens 应用程序才能支持 ARM。</span><span class="sxs-lookup"><span data-stu-id="b5072-147">Therefore, existing HoloLens applications need to be ported over to support ARM.</span></span> <span data-ttu-id="b5072-148">如前所述，Unity 2018 LTS 支持 ARM32 应用的编译，而 Unity 2019.x 支持 ARM32 和 ARM64 应用的编译。</span><span class="sxs-lookup"><span data-stu-id="b5072-148">As noted earlier, Unity 2018 LTS supports compiling ARM32 apps while Unity 2019.x supports compiling ARM32 and ARM64 apps.</span></span> <span data-ttu-id="b5072-149">最好是针对 ARM64 应用程序进行开发，因为性能方面存在本质的差异。</span><span class="sxs-lookup"><span data-stu-id="b5072-149">Developing for ARM64 applications is preferred, as there is a material difference in performance.</span></span> <span data-ttu-id="b5072-150">但是，这也需要对 ARM64 生成所有[插件依赖项](https://docs.unity3d.com/Manual/Plugins.html)。</span><span class="sxs-lookup"><span data-stu-id="b5072-150">However, this requires all [plugin dependencies](https://docs.unity3d.com/Manual/Plugins.html) to also be built for ARM64.</span></span>

<span data-ttu-id="b5072-151">请检查应用程序中的所有 DLL 依赖项。</span><span class="sxs-lookup"><span data-stu-id="b5072-151">Review all DLL dependencies in your application.</span></span> <span data-ttu-id="b5072-152">建议从项目中删除不再需要的任何依赖项。</span><span class="sxs-lookup"><span data-stu-id="b5072-152">It is advisable to remove any dependency that is no longer needed from your project.</span></span> <span data-ttu-id="b5072-153">对于所需的剩余插件，请将相应的 ARM32 或 ARM64 二进制文件引入 Unity 项目中。</span><span class="sxs-lookup"><span data-stu-id="b5072-153">For remaining plugins that are required, ingest the respective ARM32 or ARM64 binaries into your Unity project.</span></span>

<span data-ttu-id="b5072-154">引入相关的 DLL 后，从 Unity 生成一个 Visual Studio 解决方案，然后在 Visual Studio 中编译一个适用于 ARM 的 AppX，以测试应用程序是否可以针对 ARM 处理器生成。</span><span class="sxs-lookup"><span data-stu-id="b5072-154">After ingesting the relevant DLLs, build a Visual Studio solution from Unity and then compile an AppX for ARM in Visual Studio to test that your application can be built for ARM processors.</span></span> <span data-ttu-id="b5072-155">建议在源代码管理解决方案中保存应用程序作为提交内容。</span><span class="sxs-lookup"><span data-stu-id="b5072-155">It is advised to save the application as a commit in your source control solution.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b5072-156">在将生成目标更改为 ARM 后，应用程序使用 MRTK v1 可在 HoloLens 2 上运行，前提是满足其他所有要求。</span><span class="sxs-lookup"><span data-stu-id="b5072-156">Application's using MRTK v1 can be run on HoloLens 2 after changing the build target to ARM, assuming that all other requirements are met.</span></span> <span data-ttu-id="b5072-157">这包括确保你具有所有插件的 ARM 版本。</span><span class="sxs-lookup"><span data-stu-id="b5072-157">This includes making sure you have ARM versions of all your plugins.</span></span> <span data-ttu-id="b5072-158">但是，你的应用将无权使用手动跟踪和眼动跟踪等 HoloLens 2 特定功能。</span><span class="sxs-lookup"><span data-stu-id="b5072-158">However, your app won't have access to HoloLens 2 specific functions like articulated hand and eye tracking.</span></span> <span data-ttu-id="b5072-159">MRTK v1 和 MRTK v2 具有不同的命名空间，使这两种版本可位于同一项目中，这对于将一种版本转换为另一版本来说非常有用。</span><span class="sxs-lookup"><span data-stu-id="b5072-159">MRTK v1 and MRTK v2 have different namespaces that allow both versions to be in the same project, which is useful for transitioning from one to the other.</span></span>

## <a name="update-to-mrtk-version-2"></a><span data-ttu-id="b5072-160">更新到 MRTK 版本 2</span><span class="sxs-lookup"><span data-stu-id="b5072-160">Update to MRTK version 2</span></span>

<span data-ttu-id="b5072-161">[MRTK 版本 2](https://github.com/microsoft/MixedRealityToolkit-Unity) 是基于 Unity 的新工具包，支持 HoloLens（第 1 代）和 HoloLens 2，</span><span class="sxs-lookup"><span data-stu-id="b5072-161">[MRTK Version 2](https://github.com/microsoft/MixedRealityToolkit-Unity) is the new toolkit on top of Unity that supports both HoloLens (1st gen) and HoloLens 2.</span></span> <span data-ttu-id="b5072-162">其中还添加了所有新的 HoloLens 2 功能，例如手动交互和眼动跟踪。</span><span class="sxs-lookup"><span data-stu-id="b5072-162">It is also where all the new HoloLens 2 capabilities have been added, such as hand interactions and eye tracking.</span></span>

<span data-ttu-id="b5072-163">有关使用 MRTK 版本 2 的详细信息，，请查看下列资源：</span><span class="sxs-lookup"><span data-stu-id="b5072-163">Check out the following resources for more information on using MRTK version 2:</span></span>

- [<span data-ttu-id="b5072-164">MRTK 登陆页面</span><span class="sxs-lookup"><span data-stu-id="b5072-164">MRTK Landing Page</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/README.html)
- [<span data-ttu-id="b5072-165">MRTK 入门</span><span class="sxs-lookup"><span data-stu-id="b5072-165">Getting started with MRTK</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/GettingStartedWithTheMRTK.html)
- [<span data-ttu-id="b5072-166">MRTK 手部跟踪</span><span class="sxs-lookup"><span data-stu-id="b5072-166">MRTK Hands</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Input/HandTracking.html)
- [<span data-ttu-id="b5072-167">MRTK 眼动跟踪</span><span class="sxs-lookup"><span data-stu-id="b5072-167">MRTK Eye Tracking</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/EyeTracking/EyeTracking_Main.html)

### <a name="prepare-for-the-migration"></a><span data-ttu-id="b5072-168">准备迁移</span><span class="sxs-lookup"><span data-stu-id="b5072-168">Prepare for the migration</span></span>

<span data-ttu-id="b5072-169">在引入新的[适用于 MRTK v2 的 \*.unitypackage 文件](https://github.com/Microsoft/MixedRealityToolkit-Unity/releases)之前，建议清点：**1) 与 MRTK v1 集成的任何自定义生成代码**；**2) 用于输入交互或 UX 组件的任何自定义生成代码**。</span><span class="sxs-lookup"><span data-stu-id="b5072-169">Before ingesting the new [\*.unitypackage files for MRTK v2](https://github.com/Microsoft/MixedRealityToolkit-Unity/releases), it is recommended to take an inventory of **1) any custom-built code that integrates with MRTK v1** and **2) any custom-built code for input interactions or UX components**.</span></span> <span data-ttu-id="b5072-170">混合现实开发人员在引入 MRTK v2 时最常出现的冲突与输入和交互相关。</span><span class="sxs-lookup"><span data-stu-id="b5072-170">The most common and prevalent conflict for a mixed reality developer ingesting MRTK v2 involves input and interactions.</span></span> <span data-ttu-id="b5072-171">我们建议阅读并理解 [MRTK v2 输入模型](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Input/Overview.html)。</span><span class="sxs-lookup"><span data-stu-id="b5072-171">It is advised to begin reading and understanding the [MRTK v2 input model](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Input/Overview.html).</span></span>

<span data-ttu-id="b5072-172">最后，新的 [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity) 已从脚本和场景内管理器对象模型过渡到配置与服务提供程序体系结构。</span><span class="sxs-lookup"><span data-stu-id="b5072-172">Finally, the new [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity) has transitioned from a model of scripts and in-scene manager objects to a configuration and services provider architecture.</span></span> <span data-ttu-id="b5072-173">这可以建立一种更简洁的场景层次结构和体系结构模型，但需要通过学习来了解新的配置文件。</span><span class="sxs-lookup"><span data-stu-id="b5072-173">This results in a cleaner scene hierarchy and architecture model, but requires a learning curve for understanding the new configuration profiles.</span></span> <span data-ttu-id="b5072-174">因此，请阅读[混合现实工具包配置指南](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/MixedRealityConfigurationGuide.html)，以开始熟悉重要的设置和配置文件，并根据应用程序的需求进行调整。</span><span class="sxs-lookup"><span data-stu-id="b5072-174">Thus, please read the [Mixed Reality Toolkit Configuration Guide](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/MixedRealityConfigurationGuide.html) to start becoming familiar with the important settings and profiles to adjust to the needs of your application.</span></span>

### <a name="perform-the-migration"></a><span data-ttu-id="b5072-175">执行迁移</span><span class="sxs-lookup"><span data-stu-id="b5072-175">Perform the migration</span></span>

<span data-ttu-id="b5072-176">导入 [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity) 后，Unity 项目很可能会出现多种与编译器相关的错误。</span><span class="sxs-lookup"><span data-stu-id="b5072-176">After importing [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity), your Unity project most likely has many compiler-related errors.</span></span> <span data-ttu-id="b5072-177">这些错误通常是新的命名空间结构和新的组件名称造成的。</span><span class="sxs-lookup"><span data-stu-id="b5072-177">These are commonly due to the new namespace structure and new component names.</span></span> <span data-ttu-id="b5072-178">请将脚本修改为新的命名空间和组件，以解决这些错误。</span><span class="sxs-lookup"><span data-stu-id="b5072-178">Proceed to resolve these errors by modifying your scripts to the new namespaces and components.</span></span>

<span data-ttu-id="b5072-179">若要了解 HTK/MRTK 与 MRTK v2 之间的具体 API 差异，请参阅 [MRTK 版本 2 Wiki](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/HTKToMRTKPortingGuide.html) 中的移植指南。</span><span class="sxs-lookup"><span data-stu-id="b5072-179">For information on the specific API differences between HTK/MRTK and MRTK v2, see the porting guide on the [MRTK Version 2 wiki](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/HTKToMRTKPortingGuide.html).</span></span>

### <a name="best-practices"></a><span data-ttu-id="b5072-180">最佳实践</span><span class="sxs-lookup"><span data-stu-id="b5072-180">Best practices</span></span>

- <span data-ttu-id="b5072-181">优先使用 [MRTK 标准着色器](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_MRTKStandardShader.html)。</span><span class="sxs-lookup"><span data-stu-id="b5072-181">Prefer use of the [MRTK standard shader](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/README_MRTKStandardShader.html).</span></span>
- <span data-ttu-id="b5072-182">每次处理一种重大更改类型（例如：将 IFocusable 更改为 [IMixedRealityFocusHandler](https://microsoft.github.io/MixedRealityToolkit-Unity/api/Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusHandler.html)）。</span><span class="sxs-lookup"><span data-stu-id="b5072-182">Work on one breaking change type at a time (ex: IFocusable to [IMixedRealityFocusHandler](https://microsoft.github.io/MixedRealityToolkit-Unity/api/Microsoft.MixedReality.Toolkit.Input.IMixedRealityFocusHandler.html)).</span></span>
- <span data-ttu-id="b5072-183">每次更改后进行测试，并使用源代码管理。</span><span class="sxs-lookup"><span data-stu-id="b5072-183">Test after every change and use source control.</span></span>
- <span data-ttu-id="b5072-184">尽可能地使用默认 MRTK UX（按钮、盖板等）。</span><span class="sxs-lookup"><span data-stu-id="b5072-184">Use default MRTK UX (buttons, slates, etc.), when possible.</span></span>
- <span data-ttu-id="b5072-185">避免直接修改 MRTK 文件，改为创建围绕 MRTK 组件的包装器。</span><span class="sxs-lookup"><span data-stu-id="b5072-185">Refrain from modifying MRTK files directly; create wrappers around MRTK components.</span></span>
    - <span data-ttu-id="b5072-186">此操作方便将来的 MRTK 引入和更新。</span><span class="sxs-lookup"><span data-stu-id="b5072-186">This action eases future MRTK ingestions and updates.</span></span>
- <span data-ttu-id="b5072-187">查看并探索 MRTK 中提供的示例场景，尤其是 *HandInteractionExamples.scene*。</span><span class="sxs-lookup"><span data-stu-id="b5072-187">Review and explore sample scenes provided in the MRTK, especially *HandInteractionExamples.scene*.</span></span>
- <span data-ttu-id="b5072-188">使用四面体、碰撞体和 TextMeshPro 文本重新生成基于画布的 UI。</span><span class="sxs-lookup"><span data-stu-id="b5072-188">Rebuild canvas-based UI with quads, colliders, and TextMeshPro text.</span></span>
- <span data-ttu-id="b5072-189">启用[深度缓冲区共享](camera-in-unity.md#sharing-your-depth-buffers-with-windows)或[设置焦点](focus-point-in-unity.md)；首选使用 16 位深度缓冲区以提高性能。</span><span class="sxs-lookup"><span data-stu-id="b5072-189">Enable [Depth Buffer Sharing](camera-in-unity.md#sharing-your-depth-buffers-with-windows) or [set focus point](focus-point-in-unity.md); prefer to use a 16-bit depth buffer for better performance.</span></span> <span data-ttu-id="b5072-190">确保在渲染颜色的同时渲染深度。</span><span class="sxs-lookup"><span data-stu-id="b5072-190">Ensure when rendering color, to also render depth.</span></span> <span data-ttu-id="b5072-191">Unity 通常不会写入透明和文本游戏对象的深度。</span><span class="sxs-lookup"><span data-stu-id="b5072-191">Unity generally does not write depth for transparent and text gameobjects.</span></span> 
- <span data-ttu-id="b5072-192">设置单通道实例化渲染路径。</span><span class="sxs-lookup"><span data-stu-id="b5072-192">Set Single Pass Instanced Rendering Path.</span></span>
- <span data-ttu-id="b5072-193">利用 [MRTK 的 HoloLens 2 配置文件](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Profiles/Profiles.html#hololens-2-profile)</span><span class="sxs-lookup"><span data-stu-id="b5072-193">Utilize the [HoloLens 2 configuration profile for MRTK](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/Profiles/Profiles.html#hololens-2-profile)</span></span>

### <a name="testing-your-application"></a><span data-ttu-id="b5072-194">测试应用程序</span><span class="sxs-lookup"><span data-stu-id="b5072-194">Testing your application</span></span>

<span data-ttu-id="b5072-195">在 MRTK 的第 2 版中，可以直接在 Unity 中模拟手动交互，并使用新的 API 进行手动交互和眼动跟踪方面的开发。</span><span class="sxs-lookup"><span data-stu-id="b5072-195">In MRTK Version 2, you can simulate hand interactions directly in Unity as well as develop with the new APIs for hand interactions and eye tracking.</span></span> <span data-ttu-id="b5072-196">需要使用 HoloLens 2 设备才能建立令人满意的用户体验。</span><span class="sxs-lookup"><span data-stu-id="b5072-196">The HoloLens 2 device is required to create a satisfying user experience.</span></span> <span data-ttu-id="b5072-197">我们鼓励你开始学习相应的文档和工具，以加深了解。</span><span class="sxs-lookup"><span data-stu-id="b5072-197">You are encouraged to start studying the documentation and tools for greater understanding.</span></span> <span data-ttu-id="b5072-198">[MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity) 支持在 HoloLens（第 1 代）上进行开发，因此，可以在 HoloLens（第 1 代）上测试通过隔空敲击进行选择的操作。</span><span class="sxs-lookup"><span data-stu-id="b5072-198">[MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity) supports development on HoloLens (1st gen) and traditional input models, such as select via air-tap can be tested on HoloLens (1st gen).</span></span> 

## <a name="updating-your-interaction-model-for-hololens-2"></a><span data-ttu-id="b5072-199">更新 HoloLens 2 的交互模型</span><span class="sxs-lookup"><span data-stu-id="b5072-199">Updating your interaction model for HoloLens 2</span></span>

<span data-ttu-id="b5072-200">移植应用程序并为 HoloLens 2 做好准备后，可以考虑更新交互模型和全息影像设计定位。</span><span class="sxs-lookup"><span data-stu-id="b5072-200">Once your application is ported and prepped for HoloLens 2, you're ready to consider updating your interaction model and hologram design placements.</span></span>
<span data-ttu-id="b5072-201">在 HoloLens（第 1 代）中，应用程序可能会使用视线和提交交互模型，而全息影像位于相对较远的位置，因此难以放入视场。</span><span class="sxs-lookup"><span data-stu-id="b5072-201">In HoloLens (1st gen), your application likely has a gaze and commit interaction model with holograms relatively far away to fit into the field of view.</span></span>

<span data-ttu-id="b5072-202">更新应用程序设计以使其最适合 HoloLens 2 的步骤如下：</span><span class="sxs-lookup"><span data-stu-id="b5072-202">Steps to update your application design to be best suited for HoloLens 2:</span></span>
1.  <span data-ttu-id="b5072-203">MRTK 组件：根据前期工作，如果已添加 [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity)，则可以利用已根据 HoloLens 2 进行设计和优化的各种组件/脚本。</span><span class="sxs-lookup"><span data-stu-id="b5072-203">MRTK components: Per the pre-work, if you added [MRTK v2](https://github.com/microsoft/MixedRealityToolkit-Unity), there are various components/scripts to leverage that have been designed and optimized for HoloLens 2.</span></span>

2.  <span data-ttu-id="b5072-204">交互模型：考虑更新交互模型。</span><span class="sxs-lookup"><span data-stu-id="b5072-204">Interaction model: Consider updating your interaction model.</span></span> <span data-ttu-id="b5072-205">对于大多数方案，我们建议从视线和提交切换为手动。</span><span class="sxs-lookup"><span data-stu-id="b5072-205">For most scenarios, we recommend switching from gaze and commit to hands.</span></span> <span data-ttu-id="b5072-206">由于全息影像通常会超出手臂的控制范围，切换为手动可以生成远距交互指向射线和抓取手势。</span><span class="sxs-lookup"><span data-stu-id="b5072-206">With your holograms typically being out of arms-reach, switching to hands results in far interaction pointing rays and grab gestures.</span></span>

3.  <span data-ttu-id="b5072-207">全息影像的定位：切换到手动交互模型后，请考虑更靠近某些全息影像，以使用近距交互抓取手势直接与全息影像手动交互。</span><span class="sxs-lookup"><span data-stu-id="b5072-207">Hologram placement: After switching to a hands interaction model, consider moving some holograms closer to directly interact with them, by using near-interaction grab gestures with your hands.</span></span> <span data-ttu-id="b5072-208">建议靠近的、以便于抓取或交互的全息影像类型包括小目标菜单、控件、按钮，以及在抓取和检查时可放入 HoloLens 2 视场中的小型全息影像。</span><span class="sxs-lookup"><span data-stu-id="b5072-208">The types of holograms recommended to move closer to directly grab or interact are small target menus, controls, buttons, and smaller holograms that fit within the HoloLens 2 field of view when grabbing and inspecting the hologram.</span></span>
<br>
<span data-ttu-id="b5072-209">应用程序和方案各不相同，我们会根据反馈和经验教训不断改进并发布设计指南。</span><span class="sxs-lookup"><span data-stu-id="b5072-209">Every application and scenario are different, and we’ll continue to refine and post design guidance based on feedback and continued learnings.</span></span>


## <a name="additional-caveats-and-learnings-about-moving-applications-from-x86-to-arm"></a><span data-ttu-id="b5072-210">有关将应用程序从 x86 转移到 ARM 的其他注意事项和知识点</span><span class="sxs-lookup"><span data-stu-id="b5072-210">Additional caveats and learnings about moving applications from x86 to ARM</span></span>

- <span data-ttu-id="b5072-211">规整的 Unity 应用程序非常简单，因为你可以生成一个 ARM 应用程序捆绑包，或直接部署到设备，然后该捆绑包即可运行。</span><span class="sxs-lookup"><span data-stu-id="b5072-211">Straight-forward Unity applications are simple because you can build an ARM application bundle or deploy directly to the device for the bundle to run.</span></span> <span data-ttu-id="b5072-212">某些 Unity 本机插件可能会给开发带来一定的挑战。</span><span class="sxs-lookup"><span data-stu-id="b5072-212">Some Unity native plugins can present certain development challenges.</span></span> <span data-ttu-id="b5072-213">因此，必须将所有 Unity 本机插件升级到 Visual Studio 2019，然后针对 ARM 重新生成。</span><span class="sxs-lookup"><span data-stu-id="b5072-213">Because of this, you must upgrade all Unity native plugins to Visual Studio 2019 and then rebuild for ARM.</span></span>

- <span data-ttu-id="b5072-214">某个应用程序使用 Unity AudioKinetic Wwise 插件，但该版本的 Unity 没有 UWP ARM 插件，这导致需要花费大量精力将声音功能重新加入到该应用程序中，才能使该应用在 ARM 上运行。</span><span class="sxs-lookup"><span data-stu-id="b5072-214">One application used the Unity AudioKinetic Wwise plugin and that version of Unity did not have a UWP ARM plugin, which caused a considerable effort to rework sound capabilities into the application in question to run on ARM.</span></span> <span data-ttu-id="b5072-215">确保开发计划所需的所有插件都已在 Unity 中安装并可用。</span><span class="sxs-lookup"><span data-stu-id="b5072-215">Ensure that all required plugins for your development plans are installed and available in Unity.</span></span>

- <span data-ttu-id="b5072-216">在某些情况下，应用所需的插件可能不存在 UWP/ARM 插件，因此无法在 HoloLens 2 上移植和运行应用程序。</span><span class="sxs-lookup"><span data-stu-id="b5072-216">In some cases, a UWP/ARM plugin might not exist for application-required plugins, which blocks the ability to port the application and run it on HoloLens 2.</span></span> <span data-ttu-id="b5072-217">请联系插件供应商来解决该问题并提供 ARM 方面的支持。</span><span class="sxs-lookup"><span data-stu-id="b5072-217">Contact your plugin provider to resolve the issue and provide support for ARM.</span></span>

- <span data-ttu-id="b5072-218">在 HoloLens 2 上，着色器中的 minfloat（和 min16float、minint 等变量）的行为可能与 HoloLens（第 1 代）上的不同。</span><span class="sxs-lookup"><span data-stu-id="b5072-218">The minfloat (and variants such as min16float, minint, etc.…) in shaders might behave differently on HoloLens 2 than on HoloLens (1st gen).</span></span> <span data-ttu-id="b5072-219">具体而言，这些行为保证至少使用指定的位数。</span><span class="sxs-lookup"><span data-stu-id="b5072-219">Specifically, these guarantee that at least the specified number of bits will be used.</span></span> <span data-ttu-id="b5072-220">在 Intel/Nvidia GPU 上，这些位基本上被视为 32 位。</span><span class="sxs-lookup"><span data-stu-id="b5072-220">On Intel/Nvidia GPUs, these are largely treated as 32 bits.</span></span> <span data-ttu-id="b5072-221">在 ARM 上，实际上会遵循指定的位数。</span><span class="sxs-lookup"><span data-stu-id="b5072-221">On ARM, the number of bits specified is actually adhered to.</span></span> <span data-ttu-id="b5072-222">这意味着，在实践中，这些数字在 HoloLens 2 上的精度或范围可能低于 HoloLens（第 1 代）。</span><span class="sxs-lookup"><span data-stu-id="b5072-222">That means in practice, these numbers might have less precision or range on HoloLens 2 than they did on HoloLens (1st gen).</span></span>

- <span data-ttu-id="b5072-223">_asm 指令似乎在 ARM 上无法正常运行，这意味着，必须重写使用 _asm 指令的所有代码。</span><span class="sxs-lookup"><span data-stu-id="b5072-223">The _asm instructions don’t appear to work on ARM, meaning any code using _asm instructions must be rewritten.</span></span>

- <span data-ttu-id="b5072-224">ARM 不支持 SIMD 指令集，因为 xmmintrin.h、emmintrin.h、tmmintrin.h 和 immintrin.h 等各种标头在 ARM 上不可用。</span><span class="sxs-lookup"><span data-stu-id="b5072-224">The SIMD instruction set is not supported on ARM because various headers, such as xmmintrin.h, emmintrin.h, tmmintrin.h, and immintrin.h, are not available on ARM.</span></span>

- <span data-ttu-id="b5072-225">ARM 上的着色器编译器将在加载着色器，或者在着色器所依赖的设置发生更改后，在首次发出绘制调用期间运行，而不是在加载着色器时运行。</span><span class="sxs-lookup"><span data-stu-id="b5072-225">The shader compiler on ARM runs during the first draw call after the shader has been loaded or something the shader relies on has changed, not at shader load time.</span></span> <span data-ttu-id="b5072-226">对帧速率的影响可能比较明显，具体取决于需要编译的着色器数量。</span><span class="sxs-lookup"><span data-stu-id="b5072-226">The impact on framerate can be noticeable, depending on how many shaders need to be compiled.</span></span> <span data-ttu-id="b5072-227">这会对应当如何在 HoloLens 2 与 HoloLens（第 1 代）上以不同方式处理、打包、更新着色器有各种影响。</span><span class="sxs-lookup"><span data-stu-id="b5072-227">This has various implications for how shaders should be handled, packaged, updated differently on HoloLens 2 vs HoloLens (1st gen).</span></span>

## <a name="see-also"></a><span data-ttu-id="b5072-228">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b5072-228">See also</span></span>
* [<span data-ttu-id="b5072-229">安装工具</span><span class="sxs-lookup"><span data-stu-id="b5072-229">Install the tools</span></span>](install-the-tools.md)
* [<span data-ttu-id="b5072-230">MRTK 版本 2 入门</span><span class="sxs-lookup"><span data-stu-id="b5072-230">Getting started with MRTK version 2</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/GettingStartedWithTheMRTK.html)
* [<span data-ttu-id="b5072-231">从 HTK API 迁移到 MRTK API</span><span class="sxs-lookup"><span data-stu-id="b5072-231">HTK APIs to MRTK APIs</span></span>](https://microsoft.github.io/MixedRealityToolkit-Unity/Documentation/HTKToMRTKPortingGuide.html)
* [<span data-ttu-id="b5072-232">建议用于 Unity 的设置</span><span class="sxs-lookup"><span data-stu-id="b5072-232">Recommended settings for Unity</span></span>](recommended-settings-for-unity.md)
* [<span data-ttu-id="b5072-233">了解混合现实的性能</span><span class="sxs-lookup"><span data-stu-id="b5072-233">Understanding performance for Mixed Reality</span></span>](understanding-performance-for-mixed-reality.md)

